<% provide(:title, 'Cart') %>
<p id="notice"><%= notice %></p>

<h3>Shopping Cart</h3>


<% if @cart_items.any? %>
    <table class="table table-striped table-bordered">
      <tr>
        <th>Name</th>
        <th>Price</th>
        <th>Store</th>
        <th></th>
        <th></th>
      </tr>
      <% @cart_items.each do |item| %>
          <% if !item.in_list %>
              <% if Item.find_by_id(item.item_number) %>
                  <tr>
                    <td><%= item.item_name %></td>
                    <% if item.quantity > 0.to_i %>
                        <td>$<%= number_with_precision item.item_price, :precision => 2 %></td>
                        <td><%= item.store_name %></td>
                    <% else %>
                        <td>$0.00</td>
                        <td>No longer available</td>
                    <% end %>
                    <td><%= link_to "Save for later", cart_save_url(:id => item.id), :method=>:post %></td>
                    <td><%= link_to "Delete", cart_destroy_url(:id => item.id), :method=>:post %></td>
                  </tr>
              <% end %>
        <% end %>
    <% end %>
      <tr>
        <td></td>
        <td>Total: $<%= @t %></td>
        <td><%= link_to 'Checkout', checkout_url(:id => @storekeeper.id), class: "btn btn-primary" %></td>
        <td></td>
        <td></td>
    </table>
<% else %>
    Nothing in your shopping cart yet!
<% end %>


<% if @cart_items.any? %>
    <% @cart_items.each do |item| %>
        <% if item.in_list %>
    <h3>Saved Items</h3>
    <table class="table table-striped table-bordered">
      <tr>
        <th>Name</th>
        <th>Price</th>
        <th>Store</th>
        <th></th>
      </tr>
              <% if Item.find_by_id(item.item_number) %>
                  <tr>
                    <td><%= item.item_name %></td>
                    <% if item.quantity > 0.to_i %>
                        <td>$<%= number_with_precision item.item_price, :precision => 2 %></td>
                        <td><%= item.store_name %></td>
                    <% else %>
                        <td>$0.00</td>
                        <td>No longer available</td>
                    <% end %>
                    <td><%= link_to "Add to Cart", cart_add_url(:id => item.id, :sid=>@storekeeper.id), :method=>:post %></td>
                  </tr>
              <% end %>
          <% end %>
      <% end %>
<% end %>
</table>